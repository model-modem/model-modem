
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.2">
    
    
      
        <title>Build - Model Modem</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.73f7c429.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:300,400,400i,700%7CFira+Code&display=fallback">
        <style>body,input{font-family:"Montserrat",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Code",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../../assets/css/extra.css">
    
    
<!-- Add custom analytics integration here -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P2KDKQYTKC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());
  gtag('config', 'G-P2KDKQYTKC');
</script>

    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-compose-specification-build-support" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../../.." title="Model Modem" class="md-header-nav__button md-logo" aria-label="Model Modem">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 7a2 2 0 00-2 2v8h2V9h2v7h2V9h2v8h2V9a2 2 0 00-2-2H9m3-5a10 10 0 0110 10 10 10 0 01-10 10A10 10 0 012 12 10 10 0 0112 2z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Model Modem
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Build
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/model-modem/model-modem/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"/></svg>
  </div>
  <div class="md-source__repository">
    Model Modem
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../cheat-codes/" class="md-tabs__link md-tabs__link--active">
        Development
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../tech/my-stack/" class="md-tabs__link">
        Technology
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../.." class="md-tabs__link">
      About
    </a>
  </li>

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Model Modem" class="md-nav__button md-logo" aria-label="Model Modem">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 7a2 2 0 00-2 2v8h2V9h2v7h2V9h2v8h2V9a2 2 0 00-2-2H9m3-5a10 10 0 0110 10 10 10 0 01-10 10A10 10 0 012 12 10 10 0 0112 2z"/></svg>

    </a>
    Model Modem
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/model-modem/model-modem/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"/></svg>
  </div>
  <div class="md-source__repository">
    Model Modem
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" checked>
    
    <label class="md-nav__link" for="nav-1">
      Development
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Development" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../cheat-codes/" class="md-nav__link">
      Cheat Codes
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../git/cheatsheet/" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-3" type="checkbox" id="nav-1-3" >
    
    <label class="md-nav__link" for="nav-1-3">
      Python
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Python" data-md-level="2">
      <label class="md-nav__title" for="nav-1-3">
        <span class="md-nav__icon md-icon"></span>
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../py/pip/" class="md-nav__link">
      pip
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-4" type="checkbox" id="nav-1-4" >
    
    <label class="md-nav__link" for="nav-1-4">
      PHP
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="PHP" data-md-level="2">
      <label class="md-nav__title" for="nav-1-4">
        <span class="md-nav__icon md-icon"></span>
        PHP
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../php/official-docker/" class="md-nav__link">
      Official Docker
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-5" type="checkbox" id="nav-1-5" >
    
    <label class="md-nav__link" for="nav-1-5">
      SQL
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="SQL" data-md-level="2">
      <label class="md-nav__title" for="nav-1-5">
        <span class="md-nav__icon md-icon"></span>
        SQL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../sql/sql-server/" class="md-nav__link">
      SQL Server
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-6" type="checkbox" id="nav-1-6" checked>
    
    <label class="md-nav__link" for="nav-1-6">
      Docker
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Docker" data-md-level="2">
      <label class="md-nav__title" for="nav-1-6">
        <span class="md-nav__icon md-icon"></span>
        Docker
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-6-1" type="checkbox" id="nav-1-6-1" checked>
    
    <label class="md-nav__link" for="nav-1-6-1">
      Compose Specification
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Compose Specification" data-md-level="3">
      <label class="md-nav__title" for="nav-1-6-1">
        <span class="md-nav__icon md-icon"></span>
        Compose Specification
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../spec/" class="md-nav__link">
      Spec
    </a>
  </li>

        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Build
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Build
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#definitions" class="md-nav__link">
    Definitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consistency-with-image" class="md-nav__link">
    Consistency with Image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publishing-built-images" class="md-nav__link">
    Publishing built images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#illustrative-sample" class="md-nav__link">
    Illustrative sample
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-definition" class="md-nav__link">
    Build definition
  </a>
  
    <nav class="md-nav" aria-label="Build definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#context-required" class="md-nav__link">
    context (REQUIRED)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#args" class="md-nav__link">
    args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cache_from" class="md-nav__link">
    cache_from
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extra_hosts" class="md-nav__link">
    extra_hosts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isolation" class="md-nav__link">
    isolation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labels" class="md-nav__link">
    labels
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shm_size" class="md-nav__link">
    shm_size
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#target" class="md-nav__link">
    target
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementations" class="md-nav__link">
    Implementations
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../deploy/" class="md-nav__link">
      Deploy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../config/" class="md-nav__link">
      Configuration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-7" type="checkbox" id="nav-1-7" >
    
    <label class="md-nav__link" for="nav-1-7">
      Linux
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linux" data-md-level="2">
      <label class="md-nav__title" for="nav-1-7">
        <span class="md-nav__icon md-icon"></span>
        Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../linux/ubuntu/versions/" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../../mkdocs/" class="md-nav__link">
      MKDocs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    
    <label class="md-nav__link" for="nav-2">
      Technology
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Technology" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../../../tech/my-stack/" class="md-nav__link">
      My Stack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../../.." class="md-nav__link">
      About
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#definitions" class="md-nav__link">
    Definitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consistency-with-image" class="md-nav__link">
    Consistency with Image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publishing-built-images" class="md-nav__link">
    Publishing built images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#illustrative-sample" class="md-nav__link">
    Illustrative sample
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-definition" class="md-nav__link">
    Build definition
  </a>
  
    <nav class="md-nav" aria-label="Build definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#context-required" class="md-nav__link">
    context (REQUIRED)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#args" class="md-nav__link">
    args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cache_from" class="md-nav__link">
    cache_from
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extra_hosts" class="md-nav__link">
    extra_hosts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isolation" class="md-nav__link">
    isolation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labels" class="md-nav__link">
    labels
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shm_size" class="md-nav__link">
    shm_size
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#target" class="md-nav__link">
    target
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementations" class="md-nav__link">
    Implementations
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/model-modem/model-modem/edit/master/docs/dev/docker/compose/build.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="the-compose-specification-build-support">The Compose Specification - Build support<a class="headerlink" href="#the-compose-specification-build-support" title="Permanent link">⚓︎</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This document has been reproduced here from its <a href="https://github.com/compose-spec/compose-spec">original source</a> to provide a better reading experience.</p>
</div>
<p><em>Note:</em> Build is an OPTIONAL part of the Compose Specification</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">⚓︎</a></h2>
<p>Compose specification is a platform-neutral way to define multi-container applications. A Compose implementation 
focussing on development use-case to run application on local machine will obviously also support (re)building 
application from sources. The Compose Build specification allows to define the build process within a Compose file 
in a portable way.</p>
<h2 id="definitions">Definitions<a class="headerlink" href="#definitions" title="Permanent link">⚓︎</a></h2>
<p>Compose Specification is extended to support an OPTIONAL <code>build</code> subsection on services. This section define the 
build requirements for service container image. Only a subset of Compose file services MAY define such a Build 
subsection, others being created based on <code>Image</code> attribute. When a Build subsection is present for a service, it 
is <em>valid</em> for a Compose file to miss an <code>Image</code> attribute for corresponding service, as Compose implementation 
can build image from source.</p>
<p>Build can be either specified as a single string defining a context path, or as a detailled build definition. </p>
<p>In the former case, the whole path is used as a Docker context to execute a docker build, looking for a canonical 
<code>Dockerfile</code> at context root. Context path can be absolute or relative, and if so relative path MUST be resolved 
from Compose file parent folder. As an absolute path prevent the Compose file to be portable, Compose implementation 
SHOULD warn user accordingly.</p>
<p>In the later case, build arguments can be specified, including an alternate <code>Dockerfile</code> location. This one can be 
absolute or relative path. If Dockerfile path is relative, it MUST be resolved from context path.  As an absolute 
path prevent the Compose file to be portable, Compose implementation SHOULD warn user if an absolute alternate 
Dockerfile path is used.</p>
<h2 id="consistency-with-image">Consistency with Image<a class="headerlink" href="#consistency-with-image" title="Permanent link">⚓︎</a></h2>
<p>When service definition do include both <code>Image</code> attribute and a <code>Build</code> section, Compose implementation can't 
guarantee a pulled image is strictly equivalent to building the same image from sources. Without any explicit 
user directives, Compose implementation with Build support MUST first try to pull Image, then build from source 
if image was not found on registry. Compose implementation MAY offer options to customize this behaviour by user 
request.</p>
<h2 id="publishing-built-images">Publishing built images<a class="headerlink" href="#publishing-built-images" title="Permanent link">⚓︎</a></h2>
<p>Compose implementation with Build support SHOULD offer an option to push built images to a registry. Doing so, it 
MUST NOT try to push service images without an <code>Image</code> attribute. Compose implementation SHOULD warn user about 
missing <code>Image</code> attribute which prevent image being pushed.</p>
<p>Compose implementation MAY offer a mechanism to compute an <code>Image</code> attribute for service when not explicitly 
declared in yaml file. In such a case, the resulting Compose configuration is considered to have a valid <code>Image</code> 
attribute, whenever the actual raw yaml file doesn't explicitly declare one.</p>
<h2 id="illustrative-sample">Illustrative sample<a class="headerlink" href="#illustrative-sample" title="Permanent link">⚓︎</a></h2>
<p>The following sample illustrates Compose specification concepts with a concrete sample application. The sample is non-normative.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
  <span class="nt">frontend</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">awesome/webapp</span>
    <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./webapp</span>

  <span class="nt">backend</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">awesome/database</span>
    <span class="nt">build</span><span class="p">:</span>
        <span class="nt">context</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">backend</span>
        <span class="nt">dockerfile</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">../backend.Dockerfile</span>

  <span class="nt">custom</span><span class="p">:</span>
    <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">~/custom</span>
</code></pre></div>
</td></tr></table>
<p>When used to build service images from source, such a Compose file will create three docker images: </p>
<ul>
<li><code>awesome/webapp</code> docker image is build using <code>webapp</code> sub-directory within Compose file parent folder as docker build context. Lack of a <code>Dockerfile</code> within this folder will throw an error.</li>
<li><code>awesome/database</code> docker image is build using <code>backend</code> sub-directory within Compose file parent folder. <code>backend.Dockerfile</code> file is used to define build steps, this file is searched relative to context path, which means for this sample <code>..</code> will resolve to Compose file parent folder, so <code>backend.Dockerfile</code> is a sibling file.</li>
<li>a docker image is build using <code>custom</code> directory within user's HOME as docker context. Compose implementation warn user about non-portable path used to build image.</li>
</ul>
<p>On push, both <code>awesome/webapp</code> and <code>awesome/database</code> docker images are pushed to (default) registry. <code>custom</code> service image is skipped as no <code>Image</code> attribute is set and user is warned about this missing attribute.</p>
<h2 id="build-definition">Build definition<a class="headerlink" href="#build-definition" title="Permanent link">⚓︎</a></h2>
<p>The <code>build</code> element define configuration options that are applied by Compose implementations to build Docker image from source.
<code>build</code> can be specified either as a string containing a path to the build context or a detailled structure:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>services:
  webapp:
    build: ./dir
</code></pre></div>
</td></tr></table>
<p>Using this string syntax, only the build context can be configured as a relative path to the Compose file's parent folder. 
This path MUST be a directory and contain a <code>Dockerfile</code>.</p>
<p>Alternatively <code>build</code> can be an object with fields defined as follow</p>
<h3 id="context-required">context (REQUIRED)<a class="headerlink" href="#context-required" title="Permanent link">⚓︎</a></h3>
<p><code>context</code> defines either a path to a directory containing a Dockerfile, or a url to a git repository.</p>
<p>When the value supplied is a relative path, it MUST be interpreted as relative to the location of the Compose file. 
Compose implementations MUST warn user about absolute path used to define build context as those prevent Compose file 
for being portable.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>build:
  context: ./dir
</code></pre></div>
</td></tr></table>
<h3 id="dockerfile">dockerfile<a class="headerlink" href="#dockerfile" title="Permanent link">⚓︎</a></h3>
<p><code>dockerfile</code> allows to set an alternate Dockerfile. A relative path MUST be resolved from the build context.
Compose implementations MUST warn user about absolute path used to define Dockerfile as those prevent Compose file 
for being portable.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>build:
  context: .
  dockerfile: webapp.Dockerfile
</code></pre></div>
</td></tr></table>
<h3 id="args">args<a class="headerlink" href="#args" title="Permanent link">⚓︎</a></h3>
<p><code>args</code> define build arguments, i.e. Dockerfile <code>ARG</code> values.</p>
<p>Using following Dockerfile:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">ARG</span> GIT_COMMIT
<span class="k">RUN</span> <span class="nb">echo</span> <span class="s2">&quot;Based on commit: </span><span class="nv">$GIT_COMMIT</span><span class="s2">&quot;</span>
</code></pre></div>
</td></tr></table></p>
<p><code>args</code> can be set in Compose file under the <code>build</code> key to define <code>GIT_COMMIT</code>. <code>args</code> can be set a mapping or a list:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>build:
  context: .
  args:    
    GIT_COMMIT: cdc3b19
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>build:
  context: .
  args:
    - GIT_COMMIT=cdc3b19
</code></pre></div>
</td></tr></table>
<p>Value can be omited when specifying a build argument, in which case its value at build time MUST be obtained by user interaction,
otherwise build arg won't be set when building the Docker image.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>args:
  - GIT_COMMIT
</code></pre></div>
</td></tr></table>
<h3 id="cache_from">cache_from<a class="headerlink" href="#cache_from" title="Permanent link">⚓︎</a></h3>
<p><code>cache_from</code> defines a list of images that the Image builder SHOULD uses for cache resolution.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>build:
  context: .
  cache_from:
    - alpine:latest
    - corp/web_app:3.14
</code></pre></div>
</td></tr></table>
<h3 id="extra_hosts">extra_hosts<a class="headerlink" href="#extra_hosts" title="Permanent link">⚓︎</a></h3>
<p><code>extra_hosts</code> adds hostname mappings at build-time. Use the same syntax as <a href="../spec/#extra_hosts">extra_hosts</a>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>extra_hosts:
  - &quot;somehost:162.242.195.82&quot;
  - &quot;otherhost:50.31.209.229&quot;
</code></pre></div>
</td></tr></table>
<p>Compose implementations MUST create matching entry with the IP address and hostname in the container's network
configuration, which means for Linux <code>/etc/hosts</code> will get extra lines:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>162.242.195.82  somehost
50.31.209.229   otherhost
</code></pre></div>
</td></tr></table>
<h3 id="isolation">isolation<a class="headerlink" href="#isolation" title="Permanent link">⚓︎</a></h3>
<p><code>isolation</code> specifies a build’s container isolation technology. Like <a href="../spec/#isolation">isolation</a> supported values 
are platform-specific.</p>
<h3 id="labels">labels<a class="headerlink" href="#labels" title="Permanent link">⚓︎</a></h3>
<p><code>labels</code> add metadata to the resulting image. <code>labrls</code> can be set either as an array or a map.</p>
<p>reverse-DNS notation SHOULD be used to prevent labels from conflicting with those used by other software.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>build:
  context: .
  labels:
    com.example.description: &quot;Accounting webapp&quot;
    com.example.department: &quot;Finance&quot;
    com.example.label-with-empty-value: &quot;&quot;
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>build:
  context: .
  labels:
    - &quot;com.example.description=Accounting webapp&quot;
    - &quot;com.example.department=Finance&quot;
    - &quot;com.example.label-with-empty-value&quot;
</code></pre></div>
</td></tr></table>
<h3 id="shm_size">shm_size<a class="headerlink" href="#shm_size" title="Permanent link">⚓︎</a></h3>
<p><code>shm_size</code> set the size of the shared memory (<code>/dev/shm</code> partition on Linux) allocated for building Docker image. Specify
as an integer value representing the number of bytes or as a string expressing a <a href="../spec/#specifying-byte-values">byte value</a>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>build:
  context: .
  shm_size: &#39;2gb&#39;
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">build</span><span class="p">:</span>
  <span class="nt">context</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.</span>
  <span class="nt">shm_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10000000</span>
</code></pre></div>
</td></tr></table>
<h3 id="target">target<a class="headerlink" href="#target" title="Permanent link">⚓︎</a></h3>
<p><code>target</code> defines the stage to build as defined inside a multi-stage <code>Dockerfile</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>build:
  context: .
  target: prod
</code></pre></div>
</td></tr></table>
<h2 id="implementations">Implementations<a class="headerlink" href="#implementations" title="Permanent link">⚓︎</a></h2>
<ul>
<li><a href="https://docs.docker.com/compose">docker-compose</a></li>
<li><a href="https://docs.docker.com/buildx/working-with-buildx/">buildX bake</a></li>
</ul>
                
              
              
<div id="disqus_thread"></div>
<script>
  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
  /*
  var disqus_config = function () {
  this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
  this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
  };
  */
  (function () { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://modelmodem-com.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments</a>.</noscript>

            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../spec/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Spec
              </div>
            </div>
          </a>
        
        
          <a href="../deploy/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Deploy
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://www.linkedin.com/in/djsipe/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/vendor.08c56446.min.js"></script>
      <script src="../../../../assets/javascripts/bundle.6ced434e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../../..",
          features: ['search.suggest', 'navigation.tabs', 'navigation.tabs.sticky'],
          search: Object.assign({
            worker: "../../../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
      
        <script src="../../../../assets/js/extra.js"></script>
      
    
  </body>
</html>